âœ… Confirmed â€” I can see from your screenshots that even though the user selected **â€œEquipment Financingâ€** in Step 1, **additional unrelated categories** (like â€œWorking Capitalâ€ and â€œBusiness Line of Creditâ€) are being shown in Step 2.

This is incorrect behavior.

---

## ğŸ”§ Root Issue

The recommendation engine is not filtering results strictly by `purpose_of_funds === "Equipment Purchase"` when the selected financing type is **â€œEquipment Financingâ€**.

---

## âœ… Expected Behavior

| Step 1 Selection             | Step 2 Expected Categories      |
| ---------------------------- | ------------------------------- |
| **Equipment Financing**      | âœ… **Only Equipment Financing**  |
| **Working Capital**          | âœ… Working Capital, maybe LOC    |
| **Both Capital & Equipment** | âœ… Hybrid products matching both |

No other category should appear if the user is clearly applying for **equipment-specific financing**.

---

## âœ… Fix Instructions (Client Application)

### ğŸ“ File: `lib/recommendation.ts` or `hooks/useRecommendations.ts`

### ğŸ”§ Step 1: Add strict filtering by product category

Update the product matcher logic:

```ts
if (selectedPurpose === 'Equipment Financing') {
  if (product.category !== 'Equipment Financing') {
    return false; // Strictly exclude all other types
  }
}
```

### ğŸ”§ Step 2: Ensure hybrid categories (e.g. Line of Credit) are not injected unless explicitly supported

Add conditional override only for hybrid-capable products:

```ts
if (selectedPurpose === 'Both Capital & Equipment') {
  if (!['Equipment Financing', 'Term Loan'].includes(product.category)) {
    return false;
  }
}
```

---

## ğŸ” Replit Agent â€“ Required Task

* [ ] Patch filtering logic to respect the selected purpose of funds
* [ ] Exclude unrelated categories like LOC and Working Capital unless `Both` is selected
* [ ] Retest with:

  * â€œEquipment Financingâ€ â†’ âœ… Only Equipment
  * â€œWorking Capitalâ€ â†’ âœ… Only WC + LOC
  * â€œBoth Capital & Equipmentâ€ â†’ âœ… Hybrid matches only

---

Let me know if youâ€™d like to immediately retest this after Replit applies the patch.
