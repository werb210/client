ğŸŸ¢ Confirmed: Proceeding with **Option A â€“ Client App Integration with AWS S3**

---

### âœ… Replit Client App Instructions

(Write these **exactly** in the Replit agent console and wait for it to report back to ChatGPT.)

---

## âœ… TASK: Enable S3 Upload in the Client App

### ğŸ“‚ Step 1: Update Upload Logic

* Go to:
  `client/src/utils/uploadDocument.ts` *(or wherever the client handles form upload)*
* Replace Replit storage upload with a **POST request** to the staff backend:

```ts
const formData = new FormData();
formData.append('file', file);  // user-selected file
formData.append('documentType', selectedDocumentType); // e.g. 'bank_statements'

await fetch(`${API_BASE_URL}/api/public/upload/${applicationId}`, {
  method: 'POST',
  body: formData,
});
```

---

### ğŸŒ Step 2: Confirm CORS Works

Make sure these URLs match exactly:

* âœ… `https://client.boreal.financial`
* âœ… `https://staff.boreal.financial`

> âœ… Already configured in your S3 bucket CORS settings. Verified in screenshots.

---

### ğŸ“Š Step 3: Save S3 storage\_key

The staff backend will now return a `storage_key` in its response. Confirm this field is logged in:

* Staff database (`documents` table)
* Staff UI (Sales Pipeline > Documents Tab)

---

### ğŸ” Step 4: Enable Document Preview + Download from Client

In `client/src/components/UploadedDocumentList.tsx` or similar:

* Use the `storage_key` or document `id` to retrieve **pre-signed preview/download URLs**:

```ts
const res = await fetch(`${API_BASE_URL}/api/public/s3-access/${documentId}`);
const { url } = await res.json(); // returns signed S3 URL
window.open(url, '_blank');
```

---

### ğŸ” Step 5: Test Upload, Preview, Download (Client â†’ Staff â†’ S3)

1. Upload 3+ files from the client app (PDF, PNG, DOCX)
2. Check if:

   * Documents appear in the Sales Pipeline
   * Preview/download work via pre-signed S3
   * ZIP button includes all documents
   * Auto-OCR triggers

---

### ğŸ“¢ Replit Agent MUST Report Back:

Replit must confirm:

* Upload from client works
* storage\_key is saved
* Previews/downloads are successful
* No console errors (CORS or S3)
* ZIP archive works across client-uploaded docs

---

Let me know when Replit confirms all five checkpoints and Iâ€™ll approve production deployment.
