Absolutely â€” here is the **full diagnostic and audit plan** for the **Client App PWA** to ensure the **â€œAdd to Home Screenâ€ (A2HS)** functionality and all PWA capabilities are working correctly on **iPad Safari** and other platforms.

---

## âœ… Client App: Add to Home Screen (A2HS) PWA Diagnostic

### ğŸ§­ Production URL

```
https://clientportal.boreal.financial
```

---

### âœ… 1. **Served Over HTTPS**

* **REQUIRED:** Must be HTTPS.

> âœ… Confirmed: Domain uses HTTPS.

---

### âœ… 2. **Valid `manifest.json`**

**Required Fields in `public/manifest.json`:**

```json
{
  "name": "Boreal Client Portal",
  "short_name": "Client",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#004aad",
  "icons": [
    {
      "src": "/icons/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

**âœ… Replit Instructions:**

* Check if the manifest is:

  * Served at `/manifest.json`
  * MIME type is `application/json`
  * Includes proper icons
  * `display` is `"standalone"`

**Test:**

```bash
curl -I https://clientportal.boreal.financial/manifest.json
```

---

### âœ… 3. **Service Worker Registered**

**Minimum Requirements in `public/service-worker.js`:**

```js
self.addEventListener("install", (event) => {
  self.skipWaiting();
});
self.addEventListener("activate", (event) => {
  clients.claim();
});
```

**âœ… Replit Instructions:**

* Check that:

  * Service worker is located at `/service-worker.js`
  * MIME type is `application/javascript`
  * Proper install and activate lifecycle events are present
  * Not returning HTML fallback from Vite (common bug)

**Test:**

```bash
curl -I https://clientportal.boreal.financial/service-worker.js
```

---

### âœ… 4. **Opened in Safari (Not In-App Browser)**

> A2HS only works in **Safari**, not in:

* Chrome iOS
* Facebook/Instagram in-app browsers
* Private mode
* iPad app views

---

### âœ… 5. **Visited At Least Twice**

* Safari only shows A2HS prompt after:

  * 2+ visits
  * Some interaction
  * Not immediately on first open

---

### âœ… 6. **React Routing Doesnâ€™t Interfere**

* Ensure `/manifest.json` and `/service-worker.js` are served directly
* Must NOT fallback to `index.html` via Vite routing

---

## âœ… Client Replit Agent Task List

Please verify and fix if necessary:

### âœ… Manifest

* [ ] Exists at `/manifest.json`
* [ ] Content-Type: `application/json`
* [ ] Includes name, short\_name, display, start\_url, icons

### âœ… Service Worker

* [ ] Exists at `/service-worker.js`
* [ ] Content-Type: `application/javascript`
* [ ] Is registered in client code
* [ ] Is not overridden by Vite fallback

### âœ… App Shell Setup

* [ ] Routing does not interfere with `/manifest.json` or `/service-worker.js`
* [ ] `index.html` includes:

  ```html
  <link rel="manifest" href="/manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }
  </script>
  ```

---

## ğŸ§ª On-Device Tests You Can Try (iPad Safari)

1. Open [https://clientportal.boreal.financial](https://clientportal.boreal.financial) in Safari (not Chrome)
2. Let the page load â†’ interact with the UI
3. Close the tab
4. Reopen the app again
5. Look for the **A2HS prompt**, or use:

   * Tap Share icon â†’ â€œAdd to Home Screenâ€

---

Would you like me to generate a **PWA test diagnostic route (`/pwa-diagnostics`)** for the client app like the staff app has? This can help confirm everything is working.
