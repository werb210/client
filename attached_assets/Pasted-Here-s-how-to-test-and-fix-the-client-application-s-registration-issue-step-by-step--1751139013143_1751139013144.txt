Here’s how to **test and fix the client application's registration issue**, step-by-step:

---

## 🔍 Problem Summary

* **User can’t register**
* App keeps redirecting to a `/debug-test` route that doesn’t exist or doesn’t load
* Likely causes:

  * Bad route in your auth flow (`navigate("/debug-test")`)
  * Missing or unimplemented `/debug-test` component
  * API failure during registration → fallback redirect

---

## ✅ Step-by-Step Fix & Test Instructions

### 🔧 1. **Search for `navigate("/debug-test")`**

In your client repo, search all files for this:

```ts
navigate("/debug-test");
```

#### ✅ Replace With:

Depending on your app flow, it should redirect to either:

```ts
navigate("/application"); // to start the 7-step form
// or
navigate("/dashboard"); // if there's a dashboard
```

---

### 🔧 2. **Check the Register Flow Logic**

In your `pages/Register.tsx` or wherever your form handler lives:

Make sure the `try/catch` around your registration API call **only navigates after successful OTP verification**, not on error.

```ts
try {
  await registerUser({ phone, ... });
  navigate("/verify-otp"); // ✅ correct
} catch (err) {
  // ❌ don't navigate blindly
  setError("Something went wrong");
}
```

---

### 🔧 3. **Verify `/verify-otp` Route Exists**

Ensure your client router (e.g., Wouter or React Router) includes:

```tsx
<Route path="/verify-otp" component={VerifyOtpPage} />
```

Otherwise, OTP verification won’t work and users get stuck.

---

### ✅ 4. **Manual Test Procedure**

Once you fix the broken redirect, follow this test:

| Step | Action                                           | Expectation                             |
| ---- | ------------------------------------------------ | --------------------------------------- |
| 1    | Go to `https://clientportal.replit.app/register` | You see a phone/email registration form |
| 2    | Fill in details                                  | Form validates correctly                |
| 3    | Submit                                           | Redirect to `/verify-otp`, receive SMS  |
| 4    | Enter OTP                                        | Redirect to `/application` or dashboard |
| 5    | Refresh                                          | Still logged in via secure cookie       |

---

### 🧪 5. **Backend Sanity Check (Staff App)**

Ensure these endpoints respond correctly:

| Endpoint                 | Method | What to test                              |
| ------------------------ | ------ | ----------------------------------------- |
| `/api/auth/register`     | POST   | Accepts registration data                 |
| `/api/auth/verify-otp`   | POST   | Accepts OTP and returns 200 + sets cookie |
| `/api/auth/current-user` | GET    | Returns user if cookie is present         |

Use Postman or `curl` to test each manually if needed.

---

## ✅ Final Deliverables for Replit

Tell Replit to:

1. **Remove or fix any `navigate("/debug-test")` in client**
2. Ensure `/verify-otp` route and page exist and load
3. Redirect properly after OTP verification to `/application`
4. Log and show error messages on failed registration
5. Confirm all required auth routes are working (`register`, `verify-otp`, `resend`, `current-user`)
6. (Optional) Expose `/debug-test` page properly if it’s needed

---

Would you like me to generate the full replacement `Register.tsx` and OTP logic pages based on your current client structure?
