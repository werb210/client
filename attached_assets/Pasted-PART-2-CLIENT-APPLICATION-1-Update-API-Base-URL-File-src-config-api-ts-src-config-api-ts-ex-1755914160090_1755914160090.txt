PART 2 — CLIENT APPLICATION
1. Update API Base URL

File: src/config/api.ts

// src/config/api.ts
export const API_BASE_URL = "https://api.boreal.financial"; // ✅ Force production

2. Hydrate Lender Data Dynamically

Replace any local DB assumptions with live fetches:

const { data, error } = await fetch(`${API_BASE_URL}/api/lender-products`);
if (error) throw new Error("Failed to load lenders/products");

setLenders(data.lenders);
setProducts(data.products);

3. Add Health Check Fallback
async function checkApiHealth() {
  try {
    const res = await fetch(`${API_BASE_URL}/api/health`);
    const { status } = await res.json();
    return status === "ok";
  } catch {
    return false;
  }
}


If production API is down → show a non-blocking error banner.

PART 3 — ONE-TIME BACKFILL

Run a production audit to find missing lender names or mismatched IDs:

curl -s https://api.boreal.financial/api/lender-products | jq '.lenders[] | select(.name == null or .name == "")'


Update these lenders directly in the Staff App.

PART 4 — CI SCHEMA LOCK

Goal: Prevent any schema drift.
Add a CI test comparing generated DB schema against a locked reference.

Script: scripts/check-schema-integrity.ts

import { lenders, lenderProducts } from "@boreal/db/schema";
import fs from "fs";

const schemaSnapshot = JSON.parse(fs.readFileSync("schema-lock.json", "utf8"));
const currentSchema = { lenders, lenderProducts };

if (JSON.stringify(currentSchema) !== JSON.stringify(schemaSnapshot)) {
  console.error("❌ Schema drift detected!");
  process.exit(1);
}
console.log("✅ Schema integrity verified");

PART 5 — FINAL VERIFICATION
Action	Staff App	Client App
Create lender + product	✅ Visible instantly	✅ Synced live
Edit lender name/product fields	✅ Updates DB	✅ Reflects instantly
Delete lender/product	✅ Removes record	✅ Removed instantly
Schema mismatch check	✅ Fails build	✅ Cannot deploy
Production health banner	✅ Shows if API down	✅ Shows if API down
DELIVERABLES

 Force production API for both apps

 Share Drizzle schema via common package

 Add /api/lender-products endpoint

 Add /api/health endpoint + banner

 Add CI schema lock test

 Audit and backfill missing lender names

 Verify end-to-end sync live