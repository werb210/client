1 · Install dependencies
bash
Copy
Edit
cd apps/client-app
npm i libphonenumber-js react-input-mask
2 · src/utils/toE164.ts
ts
Copy
Edit
import { parsePhoneNumberFromString } from 'libphonenumber-js';

export function toE164(raw: string): string | null {
  const p = parsePhoneNumberFromString(raw, 'US');   // default country
  return p?.isValid() ? p.number : null;             // +15878881837
}
3 · src/pages/Register.tsx (key parts)
tsx
Copy
Edit
import InputMask from 'react-input-mask';
import { toE164 } from '@/utils/toE164';
import { apiFetch } from '@/lib/api';

const Register = () => {
  const [phone, setPhone] = useState('');
  const [error, setError] = useState('');

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    const formatted = toE164(phone);
    if (!formatted) return setError('Invalid phone');

    const res = await apiFetch('/auth/register', {
      method: 'POST',
      body: JSON.stringify({ phone: formatted, email, password }),
    });

    if (res.ok) navigate('/verify-otp');
    else setError((await res.json()).message);
  };

  return (
    <form onSubmit={handleSubmit}>
      <InputMask
        mask="(999) 999-9999"
        value={phone}
        onChange={(e) => setPhone(e.target.value)}
      >
        {(inputProps) => <input {...inputProps} placeholder="Phone" />}
      </InputMask>
      {/* email, password fields */}
      <button type="submit">Send Verification Code</button>
      {error && <p className="text-red-600">{error}</p>}
    </form>
  );
};
4 · src/lib/api.ts
ts
Copy
Edit
export function apiFetch(path: string, options: RequestInit = {}) {
  return fetch(`${import.meta.env.VITE_API_BASE_URL}${path}`, {
    credentials: 'include',
    mode: 'cors',
    headers: { 'Content-Type': 'application/json', ...(options.headers || {}) },
    ...options,
  });
}
5 · Environment .env & .env.production
env
Copy
Edit
VITE_API_BASE_URL=https://staffportal.replit.app/api
6 · E2E test (manual)
Open https://clientportal.replit.app/register

Enter phone as (587) 888-1837

Form converts to +15878881837

SMS OTP arrives (or Twilio test number succeeds)

/verify-otp page accepts code, redirects to /application