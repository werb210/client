Client app → ask this

Goal: “How many fields are at each level on the client side (collected vs. submitted)?”

A. Count form fields at submit time (by step & total)

// In the client app console right before submitting (Step 7 submit screen)
// 1) Gather deep keys from your form state
function deepKeys(o,p=[]){if(!o||typeof o!=='object')return[p.join('.')];let r=[];for(const k of Object.keys(o)){const v=o[k];const nk=[...p,k];if(v&&typeof v==='object'&&!Array.isArray(v))r=r.concat(deepKeys(v,nk));else r.push(nk.join('.'));}return r;}
const state = window.__APP_STATE__ || {};  // or your known store
const keys = Array.from(new Set(deepKeys(state))).filter(k=>!k.endsWith('.') && !k.match(/^\d+$/));
console.log('TOTAL FORM KEYS:', keys.length);
console.log(keys);

// 2) (Optional) Rough step buckets if your state separates steps:
const step1 = keys.filter(k => /Financial|requestedAmount|revenue|monthly|yearsInBusiness|fundsPurpose|salesHistory|accountsReceivable|fixedAssets|equipment/i.test(k));
const step2 = keys.filter(k => /selected(Category|Product|Lender|Name)/i.test(k));
const step3 = keys.filter(k => /(legalName|operatingName|business(Street|City|State|Postal|Phone|Website|StartDate|Structure)|employeeCount|estimatedYearlyRevenue)/i.test(k));
const step4 = keys.filter(k => /(firstName|lastName|applicant|email|phone|address|city|state|zip|dateOfBirth|ssn|ownership|partner)/i.test(k));
console.table([
  { step: 'Step 1', count: step1.length },
  { step: 'Step 2', count: step2.length },
  { step: 'Step 3', count: step3.length },
  { step: 'Step 4', count: step4.length }
]);


B. Count fields actually POSTed to Staff (the submission payload)

// In the same console, intercept just before your fetch call:
const _fetch = window.fetch;
window.fetch = async (url, opts) => {
  if (typeof url === 'string' && /\/v1\/applications$/.test(url) && opts?.method === 'POST') {
    try {
      const body = JSON.parse(opts.body || '{}');
      const payloadKeys = Object.keys(body);
      console.log('SUBMISSION PAYLOAD KEYS:', payloadKeys.length, payloadKeys);
    } catch {}
  }
  return _fetch(url, opts);
};

// Now click Submit once to see the payload key count (expected ~11 core keys + payload/formFields if enabled)


C. Paste back these numbers:

Total form keys at submit time (and optional per-step counts).

Total submission payload keys (and the list).