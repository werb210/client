Got you. Here’s how to **force the client app into true production mode** on Replit and prove it’s there.

# Client app — make it production

1. **Stop any dev server**

* In the workspace, click **Stop** (square). Don’t press **Run** again—production should be driven by **Deployments** only.

2. **Open Deployments → Settings**

* **Build command:** `npm run build`
* **Run command:** `npm run start`

3. **Deployment secrets (set on the Deployment, not just Account Secrets)**

* `NODE_ENV=production`
* `VITE_STAFF_API_URL=https://staff.boreal.financial/api`
* `VITE_CLIENT_APP_SHARED_TOKEN=<the exact token whose fingerprint is 294b3e442db5>`
* `VITE_LOCAL_FALLBACK=false`

4. **Deploy**

* Click **Build** → when it finishes → **Promote to production**.

5. **Hard-refresh the browser (kills dev cache/Service Worker)**

* Chrome: open the app → DevTools (F12) → right-click reload button → **Empty cache and hard reload**.
* If you use a PWA/service worker, clear “Application → Storage → Clear site data”.

---

## Quick verification (from the client Replit Shell)

```bash
# 1) Confirm you’re using the production token
node -e 'const c=require("crypto");const s=process.env.VITE_CLIENT_APP_SHARED_TOKEN||"";console.log("token_fp:",c.createHash("sha256").update(s).digest("hex").slice(0,12))'
# Expect: token_fp: 294b3e442db5

# 2) Confirm you’re hitting the live Staff API and not a local fallback
BASE="${VITE_STAFF_API_URL:-https://staff.boreal.financial/api}"
TOK="${VITE_CLIENT_APP_SHARED_TOKEN:?missing token}"
echo -n "Products: "      && curl -s -H "Authorization: Bearer $TOK" "$BASE/v1/products"  | jq 'length'
echo -n "Lenders: "       && curl -s -H "Authorization: Bearer $TOK" "$BASE/lenders"       | jq 'length'
echo -n "Required docs: " && curl -s -H "Authorization: Bearer $TOK" "$BASE/required-docs" | jq 'length'
# Expect: 44 / ~30 / ≥2
```

---

## Common gotchas (and fixes)

* **Still looks like dev?** You likely clicked **Run** in the workspace. Stop it; only the **Deployment** should be running.
* **Counts show 2/2/2:** `VITE_LOCAL_FALLBACK` isn’t false in the **Deployment** environment, or the token is wrong. Set `VITE_LOCAL_FALLBACK=false` and redeploy.
* **401 invalid\_bearer:** the token value in the client doesn’t match Staff’s current token (fingerprint must be `294b3e442db5`). Update the secret, **redeploy**, and hard-reload.
* **CORS errors from client:** Staff must allow `https://client.boreal.financial` (it’s already configured). If you changed the client domain, add it on Staff and redeploy.

That’s it—after these steps the client runs with `npm run start`, `NODE_ENV=production`, and only talks to the live Staff API.
